# 4번 피어세션 때 오류 해결 과정 공유하기

## 물류 접수 이벤트

### 오류

1.다중 입력 처리

  - 기존에 입력을 백그라운드에서 계속적으로 받아 대기큐에 넣는 방식을 구현하지 못했었다. while 무한반복문에서 계속적인 입력값을 받도록 promise와 await을 적절히 사용하고 있는줄 알았지만 프로미스를 잘못반환하고 있었다.

### 해결방식

- 현재는 Manager에서 Pos를 관리하고 있는 형태인데 우선 플래그 변수를 통해 매니저의 setInterval이 돌아가게 하였고 이후에는 무한반복문으로 포스기계에서 비동기로 언제든지 입력을 받을 수 있는 형태로 구현하였다.

```jsx
// Manager.js

while (true) {
	await this.pos.receiveInput()
	if (!this.dashBoardFlag) {
		this.dashBoard.init()
		this.dashBoardFlag = true
	}
}
```

```jsx
class Pos {
	constructor(emitter) {
		this.emitter = emitter

		this.initDisplay()
	}

	initDisplay() {
		console.log(`${INPUT_MESSAGE.LIST}\n${INPUT_MESSAGE.START}`)
	}

	receiveInput() {
		return new Promise((resolve) => {
			rl.question("", (command) => {
				if (VALIDATE_INPUT.test(command)) {
					this.emitter.emit("PosInput", command)
					resolve()
				} else {
					console.log("잘못된 입력입니다. 다시 시도해주세요.")
					resolve()
				}
			})
		})
	}
}
```


## 버전 관리 도구 만들기

### 오류

blob파일의 해쉬를 파일내용으로만 생성했을때, 파일간 파일명은 다른데 파일 내용이 다른경우 같은 해쉬를 가지는 문제

### 해결방식

blob 파일의 경우에만 파일내용+파일명을 조합하여 해시를 생성하였다.

```jsx
export const createHash = (filePath, fileContent, isBlob = false) => {
	const hash = crypto.createHash("sha256")
	return hash.update(fileContent + `${isBlob ? filePath : ""}`).digest("hex")
}
```
